from pwn import *
from math import gcd
from Crypto.Util.number import long_to_bytes

# r = remote("titan.picoctf.net", 58040)

password = 1765037049764047724348114634473658734830490852066061345686916365658618194981097216750929421734812911680434647401939068526285652985802740837961814227312100
# for _ in range(4):
#     r.recvline()
# print(r.recvline())
# r.sendline(b"d")
# print(r.recvuntil(b"Enter text to decrypt: "))
# r.sendline(str(password // 2).encode())
# data = r.recvline()[:-1].split(b"decrypted ciphertext as hex (c ^ d mod n): ")[1].decode()
# n1 = int(data, 16)
# print(r.recvline())
# for _ in range(2):
#     r.recvline()
# print(r.recvline())
# r.sendline(b"d")
# print(r.recvuntil(b"Enter text to decrypt: "))
# r.sendline(str(2).encode())
# data = r.recvline()[:-1].split(b"decrypted ciphertext as hex (c ^ d mod n): ")[1].decode()
# n2 = int(data, 16)
# print(r.recvline())
# print(n1)
# print(n2)
# print(n1 * n2)
k1 = 19601568569927091194019535235169392967559652817125927980603873940315466135696332899713782093654801193159938897051410534724431923780867246485466804428758383100794269160537987776058835376627192462104854688463824040501760371878860935355511386580823932527955048267441788462557146297599015396288986534732983489710
k2 = 2405322214524529245593927267462683182842271737491451502061482139753014883384758147429338621221812845580773937917549550220786922576550535515348138040101122155120171257035705271412954295743443411398350363239917031088890756240355204327221651539886733746919740902150590300204647263713162502861656546578555758988
k3 = 6924493910954347391339803648275642140440597607767104349721194796867912416756180202211753884262308477445749589674366355024580875089991246799957414953685684195335489851121319789154286460797904295286605861205670645864022247971811148753814962867588476363476959428670267632086796382025092860600525382339142184780
k4 = 8350403546874920665059020808177361824304898532741990528877366706938277103246366596312356662362525902158571068641490842975101997210113566847713262935516258168263691461076865333681712571902600763977189287959236771417541492345838259094477659832459184499306224904252120729661625153890937871622908393344609064976
n = 33045590714138533354531164125285258715530781260675971357725284874057396910720585570808209141314257873303008856610875724170229099940515862460601103951667826 // 2

encrypt = k1 % n
print(long_to_bytes(encrypt))
file = open("CTF_Challenge/picoctf/rsa_oracle/password.txt", "wb")
file.write(long_to_bytes(encrypt))
file.close()
# file = open("")
print(encrypt)
